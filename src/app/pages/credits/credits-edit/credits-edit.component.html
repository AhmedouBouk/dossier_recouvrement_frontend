<div class="container">
  <div class="alert error" *ngIf="errorMessage">
    <i class="material-icons">error</i>
    {{ errorMessage }}
  </div>

  <div class="card-container">
    <form (ngSubmit)="updateCredit()" #editForm="ngForm" class="edit-form">
      <div class="form-section">
        <h3 class="section-title">Informations principales</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="idCompte">Compte</label>
            <div class="input-with-icon">
              <i class="material-icons">account_circle</i>
              <input 
                id="idCompte"
                [(ngModel)]="credit.idCompte"
                name="idCompte"
                type="text"
                required
                #idCompte="ngModel">
            </div>
            <div class="error-message" *ngIf="idCompte.invalid && (idCompte.dirty || idCompte.touched)">
              Ce champ est requis
            </div>
          </div>

          <div class="form-group">
            <label for="typeGarantie">Type Garantie</label>
            <div class="input-with-icon">
              <i class="material-icons">security</i>
              <input 
                id="valeurGarantie"
                [(ngModel)]="credit.typeGarantie"
                name="typeGarantie"
                type="string"
                required
                #typeGarantie="ngModel">
            </div>
            <div class="error-message" *ngIf="typeGarantie.invalid && (typeGarantie.dirty || typeGarantie.touched)">
              Ce champ est requis
            </div>
          </div>

          <div class="form-group">
            <label for="valeurGarantie">Valeur Garantie</label>
            <div class="input-with-icon">
              <i class="material-icons">euro</i>
              <input 
                id="valeurGarantie"
                [(ngModel)]="credit.valeurGarantie"
                name="valeurGarantie"
                type="string"
                required
                #valeurGarantie="ngModel">
            </div>
            <div class="error-message" *ngIf="valeurGarantie.invalid && (valeurGarantie.dirty || valeurGarantie.touched)">
              Ce champ est requis
            </div>
          </div>

          <div class="form-group">
            <label for="montant">Montant</label>
            <div class="input-with-icon">
              <i class="material-icons">euro</i>
              <input 
                id="montant"
                [(ngModel)]="credit.montant"
                name="montant"
                type="number"
                required
                #montant="ngModel">
            </div>
            <div class="error-message" *ngIf="montant.invalid && (montant.dirty || montant.touched)">
              Ce champ est requis
            </div>
          </div>

          <div class="form-group">
            <label for="tauxInteret">Taux d'intérêt (%)</label>
            <div class="input-with-icon">
              <i class="material-icons">percent</i>
              <input 
                id="tauxInteret"
                [(ngModel)]="credit.tauxInteret"
                name="tauxInteret"
                type="number"
                step="0.01"
                required
                #tauxInteret="ngModel">
            </div>
            <div class="error-message" *ngIf="tauxInteret.invalid && (tauxInteret.dirty || tauxInteret.touched)">
              Ce champ est requis
            </div>
          </div>

          <div class="form-group">
            <label for="duree">Durée (mois)</label>
            <div class="input-with-icon">
              <i class="material-icons">calendar_today</i>
              <input 
                id="duree"
                [(ngModel)]="credit.duree"
                name="duree"
                type="number"
                required
                #duree="ngModel">
            </div>
            <div class="error-message" *ngIf="duree.invalid && (duree.dirty || duree.touched)">
              Ce champ est requis
            </div>
          </div>

          <div class="form-group">
            <label for="dateDebut">Date de début</label>
            <div class="input-with-icon">
              <i class="material-icons">event</i>
              <input 
                id="dateDebut"
                [(ngModel)]="credit.dateDebut"
                name="dateDebut"
                type="date"
                required
                #dateDebut="ngModel">
            </div>
            <div class="error-message" *ngIf="dateDebut.invalid && (dateDebut.dirty || dateDebut.touched)">
              Ce champ est requis
            </div>
          </div>

          <div class="form-group">
            <label for="statut">Statut</label>
            <div class="input-with-icon">
              <i class="material-icons">flag</i>
              <select 
                id="statut"
                [(ngModel)]="credit.statut"
                name="statut"
                required
                #statut="ngModel">
                <option value="En cours">En cours</option>
                <option value="En attente">En attente</option>
                <option value="Clôturé">Clôturé</option>
                <option value="Approuvé">Approuvé</option>
                <option value="Refusé">Refusé</option>
              </select>
            </div>
            <div class="error-message" *ngIf="statut.invalid && (statut.dirty || statut.touched)">
              Ce champ est requis
            </div>
          </div>

          <div class="form-group">
            <label for="refTransaction">Référence Transaction</label>
            <div class="input-with-icon">
              <i class="material-icons">receipt</i>
              <input 
                id="refTransaction"
                [(ngModel)]="credit.refTransaction"
                name="refTransaction"
                type="text">
            </div>
          </div>

          <div class="form-group">
            <label for="fondDossier">Fond Dossier</label>
            <div class="input-with-icon">
              <i class="material-icons">folder</i>
              <input 
                id="fondDossier"
                [(ngModel)]="credit.fondDossier"
                name="fondDossier"
                type="text"
                required
                #fondDossier="ngModel">
            </div>
            <div class="error-message" *ngIf="fondDossier.invalid && (fondDossier.dirty || fondDossier.touched)">
              Ce champ est requis
            </div>
          </div>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="cancel-btn" (click)="cancel()">
          <i class="material-icons">close</i>
          Annuler
        </button>
        <button 
          type="submit" 
          class="submit-btn" 
          [disabled]="!editForm.form.valid || isLoading">
          <i class="material-icons">save</i>
          {{ isLoading ? 'Mise à jour...' : 'Mettre à jour' }}
        </button>
      </div>
    </form>
  </div>
</div>